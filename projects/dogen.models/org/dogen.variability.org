#+title: dogen.variability
#+options: <:nil c:nil todo:nil ^:nil d:nil date:nil author:nil
#+tags: { element(e) attribute(a) module(m) }
:PROPERTIES:
:masd.codec.dia.comment: true
:masd.codec.model_modules: dogen.variability
:masd.codec.input_technical_space: cpp
:masd.codec.reference: cpp.builtins
:masd.codec.reference: cpp.std
:masd.codec.reference: cpp.boost
:masd.codec.reference: masd
:masd.codec.reference: masd.variability
:masd.codec.reference: dogen.profiles
:masd.codec.reference: dogen.tracing
:masd.codec.reference: dogen.identification
:masd.variability.profile: dogen.profiles.base.default_profile
:END:

The varibility model is responsible for managing variation in MASD.

One of the core principles of MASD is to enable the development of
"families" of software products; that is, sets of products which share
similar "traits". Those traits are encoded as "configuration" so that
we can talk about them at a higher level of abstraction. This approach
is often referred to in the literature as Software Product Line
Engineering (SPLE). MASD takes a very simplistic view of SPLE,
allowing a very restricted form of variation across a set of
well-defined features. The present model provides the basic
infrastructure required to define features, as well as to read those
features from dynamic data structures.

Note that the present model only concerns itself with the low-level
implementation of variability. You can think of it as a stack, with
this model sitting at the bottom. Above it lie the logical
representation of variability, which enables the code generator to
generate code that makes use of the infrastructure provided by this
model. But the present model is designed to be understood in complete
isolation from the layers above (and in fact, precedes the generalised
approach).

The variability space is indirectly connected to the physical dimension.
The main reason why is because we need to instantiate features across
the geometry of physical space (e.g. "for every facet...", "for every
archetype...", etc). However, we have tried to avoid coupling these two
models together because we do not think that conceptually this coupling
makes sense. That is, it just happens that we instantiate features across
the geometry of physical space, but this is not a concern o veriability -
only of its user. This decoupling was achieved by creating the concept
of template instantiation domains, which are just sets. These are mapped
elsewhere from the geometry of physical space.

* entities                                                           :module:
  :PROPERTIES:
  :masd.codec.dia.comment: true
  :END:

Contains all of the types describing variability
with Masd.

** element                                                          :element:
   :PROPERTIES:
   :masd.codec.stereotypes: Element
   :END:

Represents an element modeling some aspect of variability.

** feature                                                          :element:
   :PROPERTIES:
   :masd.codec.parent: entities::element
   :masd.codec.stereotypes: FeatureElement
   :END:

Unit of configuration within Dogen. Defines the domain of values.

*** is_partially_matchable                                        :attribute:
    :PROPERTIES:
    :masd.codec.type: bool
    :END:

Feature name can be matched partially.

** binding_point                                                    :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::enumeration, dogen::convertible
   :END:

Determines how a feature can be bound to a modeling element.

*** any                                                           :attribute:

Feature can be configured anywhere.

*** global                                                        :attribute:

Feature can only be configured in the root module.

*** element                                                       :attribute:

Feature can be configured in any modeling element.

*** property                                                      :attribute:

Feature can only be configured in a property of a modeling element.

*** operation                                                     :attribute:

Feature can only be configured in an operation of a modeling element.

** feature_model                                                    :element:

Container of all available features, organised for querying.

*** all                                                           :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<feature>
    :END:
*** by_name                                                       :attribute:
    :PROPERTIES:
    :masd.codec.type: std::unordered_map<std::string, feature>
    :END:

Features by qualified name.

*** partially_matchable                                           :attribute:
    :PROPERTIES:
    :masd.codec.type: std::unordered_map<std::string, feature>
    :END:

Features that can be partially matcheable, by qualified name.

** feature_template                                                 :element:
   :PROPERTIES:
   :masd.codec.parent: entities::element
   :masd.codec.stereotypes: FeatureElement, Templateable
   :END:

Defines a template that can be used to instantiate features.

*** default_value_overrides                                       :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<default_value_override>
    :END:

Overrides for the default value, if any.

** value_type                                                       :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::enumeration, dogen::convertible
   :END:

What values can a feature have.

*** text                                                          :attribute:

Represents a text value.

*** text_collection                                               :attribute:

Represents a collection of text values.

*** number                                                        :attribute:

Represents a numeric integral value.

*** boolean                                                       :attribute:

Represents a boolean value.

*** key_value_pair                                                :attribute:

Represents a pair of key and value.

*** comma_separated                                               :attribute:

Represents a CSV input that is split into a collection of text values.

*** comma_separated_collection                                    :attribute:

Represents a collection of CSV input that is split into a collection of text values.

** profile_template                                                 :element:
   :PROPERTIES:
   :masd.codec.parent: entities::element
   :masd.codec.stereotypes: Profilable
   :END:

Holds a set of templates for configuration points.

*** templates                                                     :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<configuration_point_template>
    :END:
** configuration_point_template                                     :element:
   :PROPERTIES:
   :masd.codec.parent: entities::element
   :masd.codec.stereotypes: Templateable
   :END:
*** untyped_value                                                 :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<std::string>
    :END:
** value                                                            :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::visitable
   :END:

Base class of all value types.

Represents a value for a configuration point, a default value for a feature, etc.

** number                                                           :element:
   :PROPERTIES:
   :masd.codec.parent: entities::value
   :END:

Represents a numeric integral value.

*** content                                                       :attribute:
    :PROPERTIES:
    :masd.codec.type: int
    :END:
** text                                                             :element:
   :PROPERTIES:
   :masd.codec.parent: entities::value
   :END:

Represents a text value.

*** content                                                       :attribute:
    :PROPERTIES:
    :masd.codec.type: std::string
    :END:
** text_collection                                                  :element:
   :PROPERTIES:
   :masd.codec.parent: entities::value
   :END:

Represents a collection of text values.

*** content                                                       :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<std::string>
    :END:
** boolean                                                          :element:
   :PROPERTIES:
   :masd.codec.parent: entities::value
   :END:

Represents a boolean value.

*** content                                                       :attribute:
    :PROPERTIES:
    :masd.codec.type: bool
    :END:
** key_value_pair                                                   :element:
   :PROPERTIES:
   :masd.codec.parent: entities::value
   :END:

Represents a pair of key and value.

*** content                                                       :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<std::pair<std::string, std::string>>
    :END:

#+begin_src mustache
The data structure was chosen to guarantee that the order is maintained from 
source.

#+end_src
** configuration                                                    :element:
   :PROPERTIES:
   :masd.codec.parent: entities::element
   :masd.codec.stereotypes: ConfigurationStore
   :END:
*** profile_bindings                                              :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<potential_binding>
    :END:

Bindings to profiles.

*** configuration_bindings                                        :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<potential_binding>
    :END:

Relationships between this bound configuration and other bound configurations.

These relationships are inferred from the relationships of the underlying model
elements.

*** source_binding_point                                          :attribute:
    :PROPERTIES:
    :masd.codec.type: binding_point
    :END:

Where was this configuration sourced from with regards to binding.

*** from_target                                                   :attribute:
    :PROPERTIES:
    :masd.codec.type: bool
    :END:

If true, this configuration was sourced from an element in the target model.

** configuration_point                                              :element:
   :PROPERTIES:
   :masd.codec.parent: entities::element
   :masd.codec.stereotypes: Valuable
   :END:

Maps a feature name to an instance value

** Nameable                                                         :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::object_template
   :END:

Elements with the ability of being named.

*** name                                                          :attribute:
    :PROPERTIES:
    :masd.codec.type: identification::entities::name
    :END:

Name of this variability element.

** Describable                                                      :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::object_template
   :END:
*** description                                                   :attribute:
    :PROPERTIES:
    :masd.codec.type: std::string
    :END:

Human readable description of the feature, used for documentation.

** Element                                                          :element:
   :PROPERTIES:
   :masd.codec.parent: entities::Nameable, entities::Describable
   :masd.codec.stereotypes: masd::object_template
   :END:
** Defaultable                                                      :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::object_template
   :END:
*** default_value                                                 :attribute:
    :PROPERTIES:
    :masd.codec.type: boost::shared_ptr<value>
    :END:

Default value for element, if any.

** Typeable                                                         :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::object_template
   :END:
*** value_type                                                    :attribute:
    :PROPERTIES:
    :masd.codec.type: value_type
    :END:

Type of the value for the feature that will result of the template instantiation.

** BindActionable                                                   :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::object_template
   :END:
*** profile_binding_action                                        :attribute:
    :PROPERTIES:
    :masd.codec.type: binding_action
    :END:
*** configuration_binding_action                                  :attribute:
    :PROPERTIES:
    :masd.codec.type: binding_action
    :END:
** Bindable                                                         :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::object_template
   :END:
*** binding_point                                                 :attribute:
    :PROPERTIES:
    :masd.codec.type: binding_point
    :END:

How the feature binds against other model elements.

** FeatureElement                                                   :element:
   :PROPERTIES:
   :masd.codec.parent: entities::Element, entities::Defaultable, entities::Typeable, entities::BindActionable, entities::Bindable
   :masd.codec.stereotypes: masd::object_template
   :END:
** Templateable                                                     :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::object_template
   :END:
*** instantiation_domain_name                                     :attribute:
    :PROPERTIES:
    :masd.codec.type: std::string
    :END:

Name of the domain to use for template instantiation.

@pre The instantiation domain name must exist.

** Valuable                                                         :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::object_template
   :END:
*** value                                                         :attribute:
    :PROPERTIES:
    :masd.codec.type: boost::shared_ptr<value>
    :END:

Value that has been assigned to this element.

** ConfigurationStore                                               :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::object_template
   :END:
*** configuration_points                                          :attribute:
    :PROPERTIES:
    :masd.codec.type: std::unordered_map<std::string, configuration_point>
    :END:

All configuration points associated with this element.

** profile                                                          :element:
   :PROPERTIES:
   :masd.codec.parent: entities::element
   :masd.codec.stereotypes: ConfigurationStore, Profilable
   :END:
*** merged                                                        :attribute:
    :PROPERTIES:
    :masd.codec.type: bool
    :END:

If true, the profile has been merged with all of its parents.

*** base_layer_profile                                            :attribute:
    :PROPERTIES:
    :masd.codec.type: std::string
    :END:

Which base layer does this profile rely on, if any.

** binding_action                                                   :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::enumeration
   :END:

What action to take when binding.

*** ignore                                                        :attribute:

Ignores the implict relationship.

*** copy                                                          :attribute:

Copy across the value of the feature from the related element

** profile_repository                                               :element:
*** by_name                                                       :attribute:
    :PROPERTIES:
    :masd.codec.type: std::unordered_map<std::string, profile>
    :END:
*** by_stereotype                                                 :attribute:
    :PROPERTIES:
    :masd.codec.type: std::unordered_map<std::string, profile>
    :END:
** configuration_model_set                                          :element:
*** models                                                        :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<configuration_model>
    :END:
** configuration_model                                              :element:
*** global                                                        :attribute:
    :PROPERTIES:
    :masd.codec.type: boost::shared_ptr<configuration>
    :END:
*** local                                                         :attribute:
    :PROPERTIES:
    :masd.codec.type: std::unordered_map<std::string, boost::shared_ptr<configuration>>
    :END:
** profile_template_repository                                      :element:
*** templates                                                     :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<profile_template>
    :END:
** potential_binding                                                :element:

Contains information about a potential binding.

*** name                                                          :attribute:
    :PROPERTIES:
    :masd.codec.type: std::string
    :END:

The name to bind to. This can represent a profile or configuration name, or an
alias.

*** realized                                                      :attribute:
    :PROPERTIES:
    :masd.codec.type: bool
    :END:

If true, the potential binding was realised into an actual binding.

** feature_template_repository                                      :element:

Stores a set of feature templates.

*** templates                                                     :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<feature_template>
    :END:
** feature_repository                                               :element:

Stores a set of features.

*** features                                                      :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<feature>
    :END:
** default_value_override                                           :element:

Stores an override for a default value.

*** key_ends_with                                                 :attribute:
    :PROPERTIES:
    :masd.codec.type: std::string
    :END:
*** default_value                                                 :attribute:
    :PROPERTIES:
    :masd.codec.type: boost::shared_ptr<value>
    :END:
** Generalizable                                                    :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::object_template
   :END:
*** parents                                                       :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<std::string>
    :END:
** Stereotypable                                                    :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::object_template
   :END:
*** stereotype                                                    :attribute:
    :PROPERTIES:
    :masd.codec.type: std::string
    :END:
** Profilable                                                       :element:
   :PROPERTIES:
   :masd.codec.parent: entities::Bindable, entities::Generalizable, entities::Stereotypable
   :masd.codec.stereotypes: masd::object_template
   :END:
** comma_separated                                                  :element:
   :PROPERTIES:
   :masd.codec.parent: entities::value
   :END:

Represents a CSV input that is split into a collection of text values.

*** content                                                       :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<std::string>
    :END:
** comma_separated_collection                                       :element:
   :PROPERTIES:
   :masd.codec.parent: entities::value
   :END:

Represents a collection of CSV input that is split into a collection of text values.

*** content                                                       :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<std::list<std::string>>
    :END:
* helpers                                                            :module:
** feature_selector                                                 :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** configuration_factory                                            :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** configuration_point_merger                                       :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** value_factory                                                    :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** building_exception                                               :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::exception
   :END:
** selection_exception                                              :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::exception
   :END:
** configuration_selector                                           :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** template_instantiator                                            :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** instantiation_exception                                          :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::exception
   :END:

An error occurred whilst instantiating templates.

** registrar                                                        :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
*** templates_repository                                          :attribute:
    :PROPERTIES:
    :masd.codec.type: entities::feature_template_repository
    :END:
*** features_repository                                           :attribute:
    :PROPERTIES:
    :masd.codec.type: entities::feature_repository
    :END:
** enum_mapper                                                      :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** enum_mapping_exception                                           :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::exception
   :END:

An error occurred whilst mapping enums to or from strings.

** relational_adapter                                               :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** adaption_exception                                               :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::exception
   :END:

An error occurred whilst adapting a model.

** configuration_points_factory                                     :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** merging_exception                                                :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::exception
   :END:

An error occurred whilst merging.

* transforms                                                         :module:
** feature_model_production_chain                                   :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** feature_template_instantiation_transform                         :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** feature_model_transform                                          :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** profile_repository_production_chain                              :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** profile_template_instantiation_transform                         :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** profile_binding_transform                                        :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** context                                                          :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::typeable, dogen::pretty_printable
   :END:

Context for transformations.

*** compatibility_mode                                            :attribute:
    :PROPERTIES:
    :masd.codec.type: bool
    :END:
*** template_instantiation_domains                                :attribute:
    :PROPERTIES:
    :masd.codec.type: std::unordered_map<std::string, std::vector<std::string>>
    :END:

Provides all of the domains to be used for template instantiation.

Example of a domain is "masd.facet" which contains the list of all available facets.
Templates (facet and profile) are then instantiated over this range, depending on 
user choices.

*** tracer                                                        :attribute:
    :PROPERTIES:
    :masd.codec.type: boost::shared_ptr<tracing::tracer>
    :END:
** profile_merging_transform                                        :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** transformation_error                                             :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::exception
   :END:

An error occurred whilst applying a transformation.

** global_configuration_binding_transform                           :element:
   :PROPERTIES:
   :masd.codec.stereotypes: dogen::handcrafted::typeable
   :END:
** profile_repository_inputs                                        :element:
*** profiles                                                      :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<entities::profile>
    :END:
*** templates                                                     :attribute:
    :PROPERTIES:
    :masd.codec.type: std::list<entities::profile_template>
    :END:
* features                                                           :module:
  :PROPERTIES:
  :masd.codec.dia.comment: true
  :END:

Features used by the variability model.

** profile                                                          :element:
   :PROPERTIES:
   :masd.variability.default_binding_point: any
   :masd.variability.key_prefix: masd.variability
   :masd.codec.stereotypes: masd::variability::feature_bundle
   :END:

Features related to profile processing.

*** profile                                                       :attribute:
    :PROPERTIES:
    :masd.variability.is_optional: true
    :masd.codec.type: masd::variability::text
    :END:

Profile associated with this configuration.

** initializer                                                      :element:
   :PROPERTIES:
   :masd.codec.stereotypes: masd::variability::initializer
   :END:
* registrar                                                         :element:
  :PROPERTIES:
  :masd.codec.stereotypes: masd::serialization::type_registrar
  :END:
* main                                                              :element:
  :PROPERTIES:
  :masd.codec.stereotypes: masd::entry_point, dogen::untypable
  :END:
* CMakeLists                                                        :element:
  :PROPERTIES:
  :masd.codec.stereotypes: masd::build::cmakelists, dogen::handcrafted::cmake
  :END:
